---
import { frameworks } from '../../data/navigation';

const currentPath = Astro.url.pathname;
const isActivePath = (path: string) => {
  const normalizedCurrent = currentPath.replace(/\/+$/, '').toLowerCase();
  const normalizedPath = path.replace(/\/+$/, '').toLowerCase();
  return path === '/'
    ? normalizedCurrent === '' || normalizedCurrent === '/'
    : normalizedCurrent.endsWith(normalizedPath);
};
---

<header class="fixed top-0 inset-x-0 z-50">
  <nav class="max-w-7xl mx-auto mt-4 flex items-center justify-between px-6 py-3">
    <a href="/" class="flex items-center">
      <img src="/logo-maskom.svg" alt="Maskom Network" width="200" height="40" decoding="async" class="h-8 w-auto" />
    </a>

    <div class="hidden md:flex items-center space-x-8 bg-white/80 backdrop-blur rounded-full border border-gray-200 px-6 py-2">
      {frameworks.map((framework) => (
        <a
          href={framework.path}
          class:list={[
            'text-sm font-heading font-medium transition-colors',
            isActivePath(framework.path)
              ? 'text-blue-600'
              : 'text-gray-800 hover:text-blue-600'
          ]}
        >
          {framework.displayName}
        </a>
      ))}
    </div>

    <div class="flex items-center space-x-4">
      <a
        href="https://panel.maskom.co.id/"
        target="_blank"
        rel="noopener noreferrer"
        class="hidden md:inline-block px-5 py-2 rounded-full text-sm font-heading font-medium text-white bg-blue-600 hover:bg-blue-700 transition"
      >
        Login
      </a>

      <button
        id="mobile-menu-button"
        class="md:hidden text-gray-800 p-2 focus:outline-none"
        aria-label="Toggle navigation"
      >
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
        </svg>
      </button>
    </div>
  </nav>

  <div id="mobile-overlay" class="fixed inset-0 bg-black/50 hidden"></div>
  <div
    id="mobile-menu"
    class="fixed top-0 right-0 w-64 h-full bg-white border-l border-gray-200 shadow-lg transform translate-x-full transition-transform"
  >
    <div class="p-4 flex flex-col space-y-4">
      <button
        id="mobile-menu-close"
        class="self-end p-2 text-gray-800 focus:outline-none"
        aria-label="Close navigation"
      >
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
        </svg>
      </button>
      {frameworks.map((framework) => (
        <a
          href={framework.path}
          class:list={[
            'block text-sm font-heading font-medium',
            isActivePath(framework.path)
              ? 'text-blue-600'
              : 'text-gray-800 hover:text-blue-600'
          ]}
        >
          {framework.displayName}
        </a>
      ))}

      <a
        href="https://panel.maskom.co.id/"
        target="_blank"
        rel="noopener noreferrer"
        class="block text-center px-4 py-2 rounded-full text-sm font-heading font-medium text-white bg-blue-600 hover:bg-blue-700 transition"
      >
        Login
      </a>
    </div>
  </div>
</header>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const button = document.getElementById('mobile-menu-button');
    const menu = document.getElementById('mobile-menu');
    const overlay = document.getElementById('mobile-overlay');
    const closeBtn = document.getElementById('mobile-menu-close');
    if (!button || !menu || !overlay || !closeBtn) return;

    const openMenu = () => {
      menu.classList.remove('translate-x-full');
      overlay.classList.remove('hidden');
      document.body.style.overflow = 'hidden';
    };

    const closeMenu = () => {
      menu.classList.add('translate-x-full');
      overlay.classList.add('hidden');
      document.body.style.overflow = '';
    };

    button.addEventListener('click', openMenu);
    overlay.addEventListener('click', closeMenu);
    closeBtn.addEventListener('click', closeMenu);
  });
</script>
