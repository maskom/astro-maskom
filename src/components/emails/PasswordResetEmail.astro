---
import EmailLayout from './EmailLayout.astro';
import EmailButton from './EmailButton.astro';
import EmailCard from './EmailCard.astro';

export interface Props {
  userName: string;
  resetLink: string;
  expiryTime: string;
  requestTime: string;
  ipAddress?: string;
  language?: 'id' | 'en';
}

const { userName, resetLink, expiryTime, requestTime, ipAddress, language = 'id' } = Astro.props;

// Translations
const translations = {
  id: {
    subject: 'Reset Password Akun Maskom Network',
    previewText: 'Permintaan reset password untuk akun Anda. Link akan kadaluarsa dalam {expiry}.',
    greeting: 'Halo {name},',
    requestReceived: 'Kami menerima permintaan untuk reset password akun Maskom Network Anda.',
    requestDetails: 'Detail Permintaan:',
    requestTime: 'Waktu Permintaan:',
    ipAddress: 'IP Address:',
    expiryInfo: 'Link reset password akan kadaluarsa dalam {expiry}.',
    securityNotice: 'Jika Anda tidak melakukan permintaan ini, abaikan email ini.',
    actionRequired: 'Untuk reset password, klik tombol di bawah:',
    resetButton: 'Reset Password',
    alternativeMethod: 'Atau salin dan paste link ini ke browser:',
    securityTips: 'Tips Keamanan:',
    tip1: 'Buat password yang kuat dan unik',
    tip2: 'Jangan gunakan password yang sama untuk akun lain',
    tip3: 'Jangan bagikan password Anda dengan siapa pun',
    tip4: 'Aktifkan two-factor authentication jika tersedia',
    contactSupport: 'Jika Anda mengalami masalah, hubungi dukungan kami.',
    teamSignature: 'Tim Keamanan Maskom Network'
  },
  en: {
    subject: 'Maskom Network Password Reset',
    previewText: 'Password reset request for your account. Link expires in {expiry}.',
    greeting: 'Hello {name},',
    requestReceived: 'We received a request to reset your Maskom Network account password.',
    requestDetails: 'Request Details:',
    requestTime: 'Request Time:',
    ipAddress: 'IP Address:',
    expiryInfo: 'The password reset link will expire in {expiry}.',
    securityNotice: 'If you didn\'t make this request, please ignore this email.',
    actionRequired: 'To reset your password, click the button below:',
    resetButton: 'Reset Password',
    alternativeMethod: 'Or copy and paste this link into your browser:',
    securityTips: 'Security Tips:',
    tip1: 'Create a strong, unique password',
    tip2: 'Don\'t use the same password for other accounts',
    tip3: 'Never share your password with anyone',
    tip4: 'Enable two-factor authentication if available',
    contactSupport: 'If you\'re having trouble, contact our support team.',
    teamSignature: 'The Maskom Network Security Team'
  }
};

const t = translations[language];
const greeting = t.greeting.replace('{name}', userName);
const previewText = t.previewText.replace('{expiry}', expiryTime);
const expiryInfo = t.expiryInfo.replace('{expiry}', expiryTime);
---

<EmailLayout subject={t.subject} previewText={previewText} language={language}>
  
  <!-- Security notice -->
  <div style="margin-bottom: 24px; padding: 20px; background-color: #FEF3C7; border-left: 4px solid #F59E0B; border-radius: 4px;">
    <p style="margin: 0 0 8px 0; font-size: 16px; color: #92400E; font-weight: 600; line-height: 1.5;">
      üîê {t.securityNotice}
    </p>
    <p style="margin: 0; font-size: 14px; color: #374151; line-height: 1.5;">
      Jika Anda tidak melakukan permintaan ini, abaikan email ini dan password Anda tidak akan berubah.
    </p>
  </div>
  
  <!-- Greeting -->
  <h1 style="margin: 0 0 16px 0; font-size: 24px; font-weight: 700; color: #111827; line-height: 1.3;">
    {greeting}
  </h1>
  
  <!-- Request message -->
  <p style="margin: 0 0 24px 0; font-size: 16px; color: #374151; line-height: 1.6;">
    {t.requestReceived}
  </p>
  
  <!-- Request Details -->
  <EmailCard title={t.requestDetails}>
    <table border="0" cellpadding="0" cellspacing="0" width="100%">
      <tr>
        <td style="padding: 8px 0; font-size: 14px; color: #6B7280; font-weight: 600; width: 120px;" valign="top">
          {t.requestTime}
        </td>
        <td style="padding: 8px 0; font-size: 16px; color: #374151;" valign="top">
          {requestTime}
        </td>
      </tr>
      {ipAddress && (
        <tr>
          <td style="padding: 8px 0; font-size: 14px; color: #6B7280; font-weight: 600;" valign="top">
            {t.ipAddress}
          </td>
          <td style="padding: 8px 0; font-size: 16px; color: #374151;" valign="top">
            {ipAddress}
          </td>
        </tr>
      )}
      <tr>
        <td style="padding: 8px 0; font-size: 14px; color: #6B7280; font-weight: 600;" valign="top">
          Kadaluarsa
        </td>
        <td style="padding: 8px 0; font-size: 16px; color: #F59E0B; font-weight: 600;" valign="top">
          {expiryTime}
        </td>
      </tr>
    </table>
  </EmailCard>
  
  <!-- Action required -->
  <h2 style="margin: 32px 0 16px 0; font-size: 20px; font-weight: 600; color: #111827; line-height: 1.3;">
    {t.actionRequired}
  </h2>
  
  <p style="margin: 0 0 24px 0; font-size: 16px; color: #374151; line-height: 1.6;">
    {expiryInfo}
  </p>
  
  <!-- Reset button -->
  <EmailButton href={resetLink} text={t.resetButton} color="primary" />
  
  <!-- Alternative method -->
  <div style="margin-top: 24px; padding: 16px; background-color: #F3F4F6; border-radius: 6px;">
    <p style="margin: 0 0 8px 0; font-size: 14px; color: #6B7280; font-weight: 600; line-height: 1.5;">
      {t.alternativeMethod}
    </p>
    <p style="margin: 0; font-size: 12px; color: #374151; line-height: 1.4; word-break: break-all;">
      {resetLink}
    </p>
  </div>
  
  <!-- Security Tips -->
  <EmailCard title={t.securityTips}>
    <ul style="margin: 0; padding-left: 20px; font-size: 16px; color: #374151; line-height: 1.6;">
      <li style="margin-bottom: 8px;">{t.tip1}</li>
      <li style="margin-bottom: 8px;">{t.tip2}</li>
      <li style="margin-bottom: 8px;">{t.tip3}</li>
      <li>{t.tip4}</li>
    </ul>
  </EmailCard>
  
  <!-- Support message -->
  <div style="margin-top: 32px; padding: 20px; background-color: #F0F9FF; border-left: 4px solid #3B82F6; border-radius: 4px;">
    <p style="margin: 0 0 8px 0; font-size: 16px; color: #1E40AF; font-weight: 600; line-height: 1.5;">
      üõ°Ô∏è {t.contactSupport}
    </p>
    <p style="margin: 0; font-size: 14px; color: #374151; line-height: 1.5;">
      Email: security@maskom.co.id | Phone: +62 21 1234 5678
    </p>
  </div>
  
  <!-- Security warning -->
  <div style="margin-top: 24px; padding: 16px; background-color: #FEE2E2; border-left: 4px solid #EF4444; border-radius: 4px;">
    <p style="margin: 0; font-size: 14px; color: #991B1B; line-height: 1.5;">
      <strong>Peringatan Keamanan:</strong> Maskom Network tidak akan pernah meminta password Anda melalui email atau telepon.
    </p>
  </div>
  
  <!-- Closing -->
  <p style="margin: 32px 0 16px 0; font-size: 16px; color: #374151; line-height: 1.6;">
    Hormat kami,
  </p>
  
  <p style="margin: 0; font-size: 16px; color: #374151; line-height: 1.6;">
    <strong>{t.teamSignature}</strong>
  </p>
  
</EmailLayout>